:global(*) {
  box-sizing: border-box;
}

.page {
  display: grid;
  place-items: center;
  gap: 14px;
  padding: 24px;
  padding-top: calc(3.5rem + 24px); /* 헤더 높이(3.5rem) + 여백 */
}

.title {
  margin: 0;
  font-weight: 800;
}
.selected {
  font-weight: 700;
  margin: 4px 0 8px;
}
.help {
  opacity: 0.72;
  font-size: 14px;
  margin: 10px 0 0;
  text-align: center;
}

/* 프레임: 좌측 반원만 보이도록 overflow hidden + 원근감 */
.frame {
  --R: 260px; /* 반지름(px) */
  --CardW: 300px;
  --CardH: 280px;
  top: 15%;
  position: relative;
  width: min(920px, 92vw);
  height: min(640px, 80vh);
  border-radius: 0;
  overflow: hidden; /* 반원만 보임 */
  background: transparent;
  box-shadow: none;
  perspective: 1200px; /* 3D 원근 */
  touch-action: none; /* 드래그 스크롤 충돌 방지 */
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0;
  flex-direction: row;
}

/* 카테고리(200px) + 카드 영역(최소 400px) = 약 600px부터 겹침 시작 */
@media (max-width: 700px) {
  .frame {
    top: 0%;
    flex-direction: column;
    height: auto;
    min-height: min(640px, 80vh);
    overflow: hidden;
    /* 작은 화면에서 카드 크기 줄이기 */
    --CardW: 240px;
    --CardH: 240px; /* 높이를 조금 더 늘려서 내용이 잘리지 않도록 */
    /* 작은 화면 스케일 팩터 (240/300 = 0.8) */
    --scale-factor: 0.8;
  }

  /* 작은 화면에서 카드 내부 요소 크기를 비율로 조정 */
  .card__thumbnail {
    height: calc(
      100px * var(--scale-factor)
    ); /* 썸네일 높이를 더 줄여서 공간 확보 */
  }

  .card__info {
    padding: calc(10px * var(--scale-factor)) calc(14px * var(--scale-factor));
    gap: calc(6px * var(--scale-factor)); /* 간격을 더 줄여서 공간 확보 */
    overflow: visible;
  }

  .card__title {
    font-size: calc(15px * var(--scale-factor)); /* 약간 더 큰 폰트 */
    line-height: 1.3; /* 줄 간격 조정 */
  }

  /* 작은 화면에서 날짜를 썸네일 내부 하단에 배치 */
  .card__thumbnail {
    position: relative; /* 날짜 절대 위치의 기준점 */
  }

  /* 작은 화면에서 card__info의 날짜 숨기기 */
  .card__info .card__date {
    display: none;
  }

  /* 작은 화면에서 썸네일 내부 날짜 표시 */
  .card__dateThumbnail {
    position: absolute;
    bottom: 8px;
    left: 8px;
    right: 8px;
    font-size: calc(11px * var(--scale-factor));
    color: #ffffff !important; /* 흰색 텍스트 */
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.85) 0%,
      rgba(0, 0, 0, 0.65) 50%,
      transparent 100%
    ); /* 하단 그라데이션 오버레이 */
    padding: 6px 8px;
    border-radius: 4px;
    backdrop-filter: blur(4px);
    z-index: 100; /* 썸네일 이미지 위에 표시 (더 높은 z-index) */
    margin: 0; /* 기본 margin 제거 */
    pointer-events: none; /* 클릭 이벤트 방지 */
  }

  /* 작은 화면에서 썸네일 이미지와 placeholder의 z-index 낮추기 */
  /* Next.js Image는 fill prop 사용 시 position: absolute이므로 z-index만 조정 */
  .card__thumbnailImage {
    z-index: 1 !important;
  }

  .card__thumbnailPlaceholder {
    z-index: 1 !important;
  }

  /* 날짜가 확실히 위에 오도록 */
  .card__dateThumbnail {
    z-index: 200 !important; /* 더 높은 z-index */
  }

  .card__desc {
    font-size: calc(12px * var(--scale-factor));
    -webkit-line-clamp: 3; /* 4줄에서 3줄로 줄여서 공간 확보 */
    line-height: 1.4; /* 줄 간격 조정 */
  }

  .card__thumbnailText {
    font-size: calc(40px * var(--scale-factor)); /* 약간 더 작게 */
  }
}

.categorySidebar {
  width: 200px;
  min-width: 200px;
  max-width: 200px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid rgba(255, 255, 255, 0.08);
  border-bottom: none;
  overflow: hidden;
  background: transparent;
  flex-shrink: 0;
}

@media (max-width: 700px) {
  .categorySidebar {
    width: 100%;
    min-width: 100%;
    max-width: 100%;
    border-right: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    max-height: 200px;
    height: auto;
    min-height: 200px;
    overflow: visible;
    flex-shrink: 0;
    order: -1;
    display: flex;
    flex-direction: column;
  }
}

:global(.dark) .categorySidebar {
  border-right-color: rgba(255, 255, 255, 0.12);
  background: transparent;
}

@media (max-width: 700px) {
  :global(.dark) .categorySidebar {
    border-right: none;
    border-bottom-color: rgba(255, 255, 255, 0.12);
  }
}

.categoryHeader {
  padding: 20px 16px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
  flex-shrink: 0;
}

@media (max-width: 700px) {
  .categoryHeader {
    padding: 12px 16px;
    flex-shrink: 0;
  }
}

.categoryTitle {
  margin: 0;
  font-size: 14px;
  font-weight: 700;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: rgba(0, 0, 0, 0.7) !important;
}

:global(.dark) .categoryTitle {
  color: rgba(255, 255, 255, 0.9) !important;
}

.categoryList {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 8px;
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
}

@media (max-width: 700px) {
  .categoryList {
    padding: 4px 8px;
    max-height: 160px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1 1 auto;
    min-height: 0;
  }

  /* 작은 화면에서 카테고리 폰트 크기 유지 (현재 설정값) */
  .categoryButton {
    font-size: 14px !important; /* 작은 화면: 14px 유지 */
  }

  .categoryName[data-depth="0"] {
    font-size: 14px !important; /* 작은 화면: 14px 유지 */
  }

  .categoryName[data-depth="1"] {
    font-size: 13px !important; /* 작은 화면: 13px 유지 */
  }

  .categoryName[data-depth="2"] {
    font-size: 12px !important; /* 작은 화면: 12px 유지 */
  }
}

.categoryList::-webkit-scrollbar {
  width: 6px;
}

.categoryList::-webkit-scrollbar-track {
  background: transparent;
}

.categoryList::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
}

.categoryList::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

.categoryItem {
  margin-bottom: 2px;
}

.categoryButton {
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 10px 12px;
  margin-bottom: 2px;
  cursor: pointer;
  border-radius: 8px;
  background: transparent;
  border: none;
  color: #000000 !important;
  transition: background 0.2s ease, transform 0.2s ease;
  font-size: 18px; /* 큰 화면: 18px */
  font-weight: 500;
}

:global(.dark) .categoryButton {
  color: #ffffff !important;
}

.categoryButton:hover {
  background: rgba(0, 0, 0, 0.05);
}

:global(.dark) .categoryButton:hover {
  background: rgba(255, 255, 255, 0.08);
  color: rgba(255, 255, 255, 1) !important;
}

.categoryButton:active {
  transform: scale(0.98);
}

.categoryButtonSelected {
  background: rgba(96, 165, 250, 0.15) !important;
  color: #60a5fa !important;
  font-weight: 600;
}

.categoryButtonSelected:hover {
  background: rgba(96, 165, 250, 0.2) !important;
}

.categoryButtonAll {
  font-weight: 600;
  margin-bottom: 8px;
}

.categoryToggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  padding: 0;
  background: transparent;
  border: none;
  cursor: pointer;
  color: rgba(0, 0, 0, 0.7) !important;
  border-radius: 4px;
  transition: background 0.2s ease, transform 0.2s ease;
  flex-shrink: 0;
}

:global(.dark) .categoryToggle {
  color: rgba(255, 255, 255, 0.85) !important;
}

.categoryToggle:hover {
  background: rgba(0, 0, 0, 0.08);
  color: rgba(0, 0, 0, 0.9) !important;
}

:global(.dark) .categoryToggle:hover {
  background: rgba(255, 255, 255, 0.1);
  color: rgba(255, 255, 255, 0.95) !important;
}

.categorySpacer {
  width: 20px;
  flex-shrink: 0;
}

.categoryName {
  flex: 1;
  user-select: none;
  transition: none;
}

.categoryName[data-depth="0"] {
  font-weight: 600;
  font-size: 18px; /* 큰 화면: 18px */
  color: #000000 !important;
}

:global(.dark) .categoryName[data-depth="0"] {
  color: #ffffff !important;
}

.categoryName[data-depth="1"] {
  font-weight: 500;
  font-size: 18px; /* 큰 화면: 18px */
  color: rgba(0, 0, 0, 0.85) !important;
}

:global(.dark) .categoryName[data-depth="1"] {
  color: rgba(255, 255, 255, 0.9) !important;
}

.categoryName[data-depth="2"] {
  font-weight: 400;
  font-size: 18px; /* 큰 화면: 18px */
  color: rgba(0, 0, 0, 0.75) !important;
}

:global(.dark) .categoryName[data-depth="2"] {
  color: rgba(255, 255, 255, 0.85) !important;
}

.categoryIndicator {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 60%;
  background: linear-gradient(180deg, #60a5fa, #3b82f6);
  border-radius: 0 2px 2px 0;
  box-shadow: 0 0 8px rgba(96, 165, 250, 0.4);
}

.categoryChildren {
  overflow: hidden;
  transition: max-height 0.3s ease, opacity 0.3s ease;
  margin-left: 8px;
  border-left: 1px solid rgba(255, 255, 255, 0.06);
  padding-left: 8px;
}

.ringContainer {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 0;
  min-height: min(640px, 80vh);
  overflow: visible; /* 카드가 컨테이너 밖으로 나가도 보이게 */
  /* 위아래 가장자리 페이드아웃 효과 */
  mask-image: linear-gradient(
    to bottom,
    transparent 0%,
    black 10%,
    black 90%,
    transparent 100%
  );
  -webkit-mask-image: linear-gradient(
    to bottom,
    transparent 0%,
    black 10%,
    black 90%,
    transparent 100%
  );
}

@media (max-width: 700px) {
  .ringContainer {
    width: 100%;
    min-height: min(500px, 60vh);
    flex: 1 1 auto;
    order: 1;
    margin-top: 0;
    padding-top: 0;
    overflow: visible; /* 카드가 컨테이너 밖으로 나가도 보이게 */
    /* 위아래 가장자리 페이드아웃 효과 유지 */
    mask-image: linear-gradient(
      to bottom,
      transparent 0%,
      black 10%,
      black 90%,
      transparent 100%
    );
    -webkit-mask-image: linear-gradient(
      to bottom,
      transparent 0%,
      black 10%,
      black 90%,
      transparent 100%
    );
  }
}

.axis {
  position: absolute;
  top: 50%;
  right: calc(
    -0.5 * var(--R)
  ); /* 축을 프레임 오른쪽 밖에서 안쪽으로 50% 이동 */
  transform: translateY(-50%);
  transform-style: preserve-3d;
  width: 1px;
  height: 1px;
}

/* 카운터: 카드 우측에 배치 */
/* frame 내부, ringContainer 밖에 위치 */
.counter {
  position: absolute;
  top: 50%;
  right: 1%; /* frame의 오른쪽에서 10% 위치 (카드 우측) */
  transform: translateY(-50%);
  font-size: 18px;
  font-weight: 700;
  color: #1e293b;
  pointer-events: none;
  z-index: 2000;
  white-space: nowrap;
  padding: 10px 16px;
  background: rgba(255, 255, 255, 1);
  border: 2px solid transparent;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(8px);
  overflow: hidden;
}

/* 프로그레스 테두리 */
.counter::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 8px;
  background: conic-gradient(
    from 0deg,
    #60a5fa 0deg,
    #60a5fa calc(var(--progress, 0) * 360deg),
    rgba(0, 0, 0, 0.1) calc(var(--progress, 0) * 360deg),
    rgba(0, 0, 0, 0.1) 360deg
  );
  padding: 2px;
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask-composite: exclude;
  pointer-events: none;
  z-index: -1;
}

:global(.dark) .counter {
  color: #e5e7eb;
  background: rgba(15, 23, 42, 1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

:global(.dark) .counter::before {
  background: conic-gradient(
    from 0deg,
    #60a5fa 0deg,
    #60a5fa calc(var(--progress, 0) * 360deg),
    rgba(255, 255, 255, 0.1) calc(var(--progress, 0) * 360deg),
    rgba(255, 255, 255, 0.1) 360deg
  );
}

@media (max-width: 700px) {
  .counter {
    /* 작은 화면: ringContainer와 함께 반응형으로 조정 */
    right: 1%;
    top: 65%; /* 아래로 조금 이동 (50% -> 55%) */
    transform: translateY(-50%); /* 기존 transform 유지 */
    /* font-size: 16px; */
    padding: 8px 12px;
  }
}

@media (max-width: 700px) {
  .axis {
    /* 작은 화면: 선택된 카드(180도)가 화면 중앙에 오도록 조정 */
    /* 선택된 카드는 180도 위치 = 원의 중심에서 왼쪽으로 반지름만큼 */
    /* 카드가 중앙에 오려면: 원의 중심이 중앙 + 반지름 위치 */
    left: calc(80% + var(--R));
    right: auto;
    transform: translate(-50%, -50%);
  }
}

/* 카드 공통 */
.card {
  position: absolute;
  left: 0;
  top: 0; /* 축 기준으로 배치 */
  width: var(--CardW);
  height: var(--CardH);
  margin-left: calc(
    -1 * var(--CardW)
  ); /* 축에서 왼쪽으로 끄집어냄(반원 노출) */
  border-radius: 16px;
  background: #ffffff; /* 라이트 모드 기본 배경 */
  color: #1e293b;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  font-weight: 800;
  letter-spacing: 0.02em;
  box-shadow: 0 16px 44px rgba(0, 0, 0, 0.45);
  transform-origin: center center; /* 회전은 축(.axis) 기준 */
  will-change: transform, opacity, filter;
  transition: filter 0.15s ease;
  outline: none;
  border: none;
  padding: 0;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-style: preserve-3d;
  perspective: 1000px;
  -webkit-transform: translateZ(0);
  /* 초기 상태: 위치가 설정되기 전까지 숨김 (펼쳐지는 현상 방지) */
  opacity: 0;
  visibility: hidden;
}

/* 다크 모드: 밝은 그림자로 대비 강화 */
:global(.dark) .card {
  background: #0f172a !important;
  color: #e5e7eb !important;
  box-shadow: 0 12px 32px rgba(255, 255, 255, 0.08),
    /* 밝은 확산 그림자 */ 0 0 0 1px rgba(255, 255, 255, 0.14); /* 가장자리 라이트 라인 */
}

.card:focus-visible {
  box-shadow: 0 0 0 3px #60a5fa, 0 16px 44px rgba(0, 0, 0, 0.45);
}

.card__label {
  font-size: 18px;
  padding: 16px;
}

/* 카드 컨텐츠 레이아웃 */
.card__content {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/* 썸네일 */
.card__thumbnail {
  position: relative;
  width: 100%;
  height: 140px;
  flex-shrink: 0;
  overflow: hidden;
  background: #1e293b;
}

.card__thumbnailImage {
  object-fit: cover;
}

.card__thumbnailPlaceholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
}

.card__thumbnailText {
  font-size: 48px;
  font-weight: 700;
  color: #64748b;
  text-transform: uppercase;
}

/* 카드 정보 */
.card__info {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 12px 16px;
  gap: 8px;
  overflow: hidden;
  transform: translateZ(0); /* 텍스트 레이어 분리 */
  -webkit-transform: translateZ(0);
}

.card__title {
  font-size: 16px;
  font-weight: 700;
  line-height: 1.4;
  margin: 0;
  color: #1e293b; /* 라이트 모드 기본 색상 */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: auto;
}

.card__date {
  font-size: 12px;
  color: #64748b; /* 라이트 모드 기본 색상 */
  margin: 0;
  font-weight: 800;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: auto;
}

.card__desc {
  font-size: 13px;
  color: #475569; /* 라이트 모드 기본 색상 */
  margin: 0;
  line-height: 1.5;
  font-weight: 600;
  display: -webkit-box;
  -webkit-line-clamp: 4;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  overflow-y: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: auto;
}

/* 다크 모드 텍스트 색상 */
:global(.dark) .card__title {
  color: #e5e7eb !important;
}

:global(.dark) .card__date {
  color: #94a3b8 !important;
}

:global(.dark) .card__desc {
  color: #cbd5e1 !important;
}

/* 선택 강조 (왼쪽 중앙 근처) */
.card--hot {
  filter: brightness(1.18) saturate(1.12);
  border: 3px solid rgba(91, 162, 255, 0.6); /* #97adc9 with 60% opacity */
}

/* 왼쪽 중앙 마커(선택 지점) */
.marker {
  --sz: 18px;
  position: absolute;
  left: calc(50% - var(--R) - 10px);
  top: 50%;
  width: 0;
  height: 0;
  border-top: var(--sz) solid transparent;
  border-bottom: var(--sz) solid transparent;
  border-right: calc(var(--sz) * 1.2) solid #60a5fa;
  transform: translate(-50%, -50%);
  filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.35));
  pointer-events: none;
  display: none; /* 배경/마커 숨김 */
}
